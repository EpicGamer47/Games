package singlePlayer;

import static common.Piece.*;

import java.util.EnumMap;
import common.Board;
import common.Piece;
import common.Ranker;

public class PointRanker implements Ranker {
	double mult;
	
	public PointRanker() { 
		mult = 1;
	}
	
	public PointRanker(double mult) {
		this.mult = mult;
	}
	
	public static EnumMap<Piece, double[]> map;
	
	static {
		map = new EnumMap<Piece, double[]>(Piece.class);
		
		map.put(PAWN, new double[] {
                   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
                   5.0,  5.0,  5.0,  5.0,  5.0,  5.0,  5.0,  5.0,
                   1.0,  1.0,  2.0,  3.0,  3.0,  2.0,  1.0,  1.0,
                   0.5,  0.5,  1.0,  2.5,  2.5,  1.0,  0.5,  0.5,
                   0.0,  0.0,  0.0,  2.0,  2.0,  0.0,  0.0,  0.0,
                   0.5, -0.5, -1.0,  0.0,  0.0, -1.0, -0.5,  0.5,
                   0.5,  1.0, 1.0,  -2.0, -2.0,  1.0,  1.0,  0.5,
                   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0
				});
		
		map.put(KNIGHT, new double[] {
				  -5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0,
                  -4.0, -2.0,  0.0,  0.0,  0.0,  0.0, -2.0, -4.0,
                  -3.0,  0.0,  1.0,  1.5,  1.5,  1.0,  0.0, -3.0,
                  -3.0,  0.5,  1.5,  2.0,  2.0,  1.5,  0.5, -3.0,
                  -3.0,  0.0,  1.5,  2.0,  2.0,  1.5,  0.0, -3.0,
                  -3.0,  0.5,  1.0,  1.5,  1.5,  1.0,  0.5, -3.0,
                  -4.0, -2.0,  0.0,  0.5,  0.5,  0.0, -2.0, -4.0,
                  -5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0
				});
		
		map.put(BISHOP, new double[] {
			      -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0,
			      -1.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -1.0,
			      -1.0,  0.0,  0.5,  1.0,  1.0,  0.5,  0.0, -1.0,
			      -1.0,  0.5,  0.5,  1.0,  1.0,  0.5,  0.5, -1.0,
			      -1.0,  0.0,  1.0,  1.0,  1.0,  1.0,  0.0, -1.0,
			      -1.0,  1.0,  1.0,  1.0,  1.0,  1.0,  1.0, -1.0,
			      -1.0,  0.5,  0.0,  0.0,  0.0,  0.0,  0.5, -1.0,
			      -2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0
				});
		
		map.put(ROOK, new double[] {
				   0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,
			       0.5,  1.0,  1.0,  1.0,  1.0,  1.0,  1.0,  0.5,
			      -0.5,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -0.5,
			      -0.5,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -0.5,
			      -0.5,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -0.5,
			      -0.5,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -0.5,
			      -0.5,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -0.5,
			       0.0,   0.0, 0.0,  0.5,  0.5,  0.0,  0.0,  0.0
				});
		
		map.put(QUEEN, new double[] {
				  -2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0,
			      -1.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -1.0,
			      -1.0,  0.0,  0.5,  0.5,  0.5,  0.5,  0.0, -1.0,
			      -0.5,  0.0,  0.5,  0.5,  0.5,  0.5,  0.0, -0.5,
			       0.0,  0.0,  0.5,  0.5,  0.5,  0.5,  0.0, -0.5,
			      -1.0,  0.5,  0.5,  0.5,  0.5,  0.5,  0.0, -1.0,
			      -1.0,  0.0,  0.5,  0.0,  0.0,  0.0,  0.0, -1.0,
			      -2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0
				});
		
		map.put(KING, new double[] {
			      -3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0,
			      -3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0,
			      -3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0,
			      -3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0,
			      -2.0, -3.0, -3.0, -4.0, -4.0, -3.0, -3.0, -2.0,
			      -1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0,
			       2.0,  2.0,  0.0,  0.0,  0.0,  0.0,  2.0,  2.0,
			       2.0,  3.0,  1.0,  0.0,  0.0,  1.0,  3.0,  2.0
				});
	}


	@Override
	public double rank(Board b, int n, int l) {
		final double standard = 1;
		
		if (b.board[n + l * 8] == null)
			return 0;
		
		long i = 1L << (n + l * 8);
		
		if ((b.white & i) != 0)
			return  standard * map.get(b.board[n + l * 8])[n + l * 8];
		else
			return -standard * map.get(b.board[n + l * 8])[n + (7 - l) * 8];
	}
}